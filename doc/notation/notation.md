# Loopian記法

## ◆Loopianについて

LoopianはLive Codingを実践するために開発した一連のシステムです。
Live Codingとは、リアルタイムにプログラムを書くことで音楽を生成していくパフォーマンスのことです。
また観客は、音楽を聴くだけでなく、プロジェクターで投影された映像でプログラムをリアルタイムに書いている様子を見ることができます。
このようにLive Codingでは、プログラムを書くことそのものを、パフォーマンスとして捉えます。

Loopianも同様に、テキストで音楽情報を入力し、リアルタイムに音楽を変えていくことが可能です。
また単に音を鳴らすだけではなく、アプリの背景に再生中の音楽にシンクロしたグラフィックを表示します。
ただし、Loopianは一般的なLive Codingとは違い、プログラミングの形式でテキストを入力するのではなく、ターミナル、シェル等で一行ずつコマンドを書くように、一行単位で音楽的指示を入力していきます。
このように、Loopianには、他のLive Codingとは若干趣きの違う幾つかの特徴があります。
以下に、Loopianの主な特徴を挙げてみましょう。

- 上述のように、指示は一行単位で入力し、アプリは一行ごとに文字列で反応を返します。あたかもアプリとチャットしているようなインターフェースとなっています。
- 基本的にピアノ音色のみを扱います。詳細な仕様はピアノ音色を鳴らすことを意識して設計されています。このため比較的落ち着きのあるクラシカルな雰囲気の音楽を志向します。
- 音程の指示は、C,D,E,F...といった音名や数値ではなく、移動ドの考えに基づき、ドレミファソラシドの階名によって指示します。
- Loopian記法はより音楽の仕組みに寄り添った体系となっており、将来的には教育分野でこの記法を利用するといった使い方も考えられます。

現在Loopianのシステムには、PC上で動作する専用アプリ"Loopian::APP"と、アプリと連携して動作するデバイス"Loopian::ORBIT"が存在します。
Loopian::APPは、Loopianの思想を体現する中核を成しているので、このアプリを単にLoopianと呼んでも構いません。
今後も、このLoopianの思想に基づいた様々なアプリ、デバイスが出現する可能性もあります。


## ◆Loopian記法の基本的な考え方

これより、Loopian記法について詳細に説明しますが、まずこの記法の特徴やその背景について、最初に説明します。

### 移動ドと音程表記について

すでにLoopianの紹介の項で述べたとおり、本アプリでは音程を階名によって指示します。
音楽教育の場では、音程をドレミファソラシドで示す時、固定ド、移動ドのどちらが良いかという論争があります。一般的には、専門教育が固定ドで行われているため、ほとんどの教育の場で固定ドが使われることが多いようです。
しかし、本アプリでは音程は移動ドで表現されるべき、という開発者の背景思想があります。
移動ドそのものについては、ここでは詳細に説明しませんが、例えばヘ長調でFを演奏したとき、その音はヘ長調の主音なので、移動ドでは「ド」と呼びます。
このように、調によってドレミファソラシドの位置が変わる読み方を移動ドと言います。

本アプリでは、世の中の音楽ツールではあまり一般的でない移動ドによって音程指示を行います。
また、移動ドによる音程指示の理論的背景として、トニックソルファ法、コダーイシステムによるソルミゼーションを参考にしています。

では、Loopian記法による階名の表記を以下に紹介します。
|階名|ド|レ|ミ|ファ|ソ|ラ|シ|
|-|-|-|-|-|-|-|-|
|表記|d|r|m|f|s|l|t|
|半音上の表記|di|ri|mi|fi|si|li|ti|
|半音下の表記|da|ra|ma|fa|sa|la|ta|

### 和音の表記について

通常和音の表記はコードネームを使うのが一般的です。
例えば、Fmaj7と書くと、Fを根音とした長七和音を意味します。しかし、音程表記が移動ドで表記するのに和音を音名で表記することは矛盾しますし、アプリ内での記述の一貫性が取れなくなります。
従って、Loopianでは和音においても相対的な表記で音程を指定します。
例えば、冒頭のFmaj7をハ長調で演奏したい場合、IVmaj7と表記します。Fはハ長調の主音のCからみて４番目の音だからです。
このように、Loopian表記では、和音の根音の表記をローマ数字風にI,Vを使って表現します。ローマ数字はその調の主音からの距離を表します。

Loopian記法による和音の根音の表記を以下に紹介します。
|主音からの距離|一度|二度|三度|四度|五度|六度|七度|
|-|-|-|-|-|-|-|-|
|根音の表記|I|II|III|IV|V|VI|VII|

### ピアノ音源向けの記法

Loopian記法はピアノ１台分の音楽を再生するように考慮されています。
Loopianでは、４つのパートを独立に記述することができますが、それらは、左手を2パート、右手を2パートで構成されます。また、すべての演奏情報は出力時にMIDI 1ch.のみしか出力しません。
さらに、ペダルは音楽全体で一つしかコントロールしません。

## ◆基本的な表記

ここから具体的な表記について記述していきます。
楽譜において各音符は最低でも、音価と音程を記述する必要があります。音価とは、音符の長さのことで、一般には四分音符、八分音符といった名称で指定されます。
Loopian記法では、音価、音程の順で音符をテキストで表現します。
例えば、四分音符のドの音符は `qd` です。`q` は四分音符を表します。
以下に音価の表記について紹介します。

|音価|二分音符|四分音符|八分音符|十六分音符|三十二分音符|
|-|-|-|-|-|-|
|表記|h|q|e|v|w|
|付点時の表記|h'|q'|e'|v'|未対応|
|三連符の表記|3h|3q|3e|3v|3w|

音価は全ての音符に書いても良いですが、前の音符と同じであれば表記は省略することができます。

一般の楽譜では音符を時間順に並べることで、旋律を表現することができます。loopian記法では、音符を `,` （カンマ）で区切って連続して記述することで、旋律を表現します。また小節線は `/` （スラッシュ）で区切ります。
また、一つの旋律は角括弧で括ります。

上記のルールを用いて、有名なベートーヴェンの第九のメロディを、４小節分Loopian記法で記述してみましょう。

```
[qm,m,f,s/s,f,m,r/d,d,r,m/q'm,er,hr]
```

第九の有名な旋律はDから始まりますが、ニ長調なので、ドから始まります。始めから３小節はすべて四分音符なので、最初の音符に `q` を書いて後の音符は省略できます。
4小節目の頭は、付点四分音符なので `'q` となり、次は八分音符、そして最後は二分音符となります。

さらに長い音価を指定したい場合、またもう少し微妙な長さの音価を指定したいとき、`.` （ピリオド）を使って特定の音符の長さを整数倍で表現することができます。
ピリオドは階名の後ろにつけます。２倍の時は一つ、３倍の時は二つ、と長さが増えるたびにピリオドの数を足していきます。

例えば、付点四分音符は八分音符が三つ分の長さです。上で４小節目の頭にあるミの付点四分音符は `eq..` と表現することが可能です。
ピリオドを使うと、先ほどの第九のメロディは以下のようにも記述できます。
```
[qm,m,f,s/s,f,m,r/d,d,r,m/em..,r,hr]
```
